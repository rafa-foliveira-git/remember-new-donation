<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Adicionar Evento ao Google Agenda</title>
    <script>
        window.onload = function() {
            // Calcula a data atual + 90 dias
            const today = new Date();
            const startDate = new Date(today);
            startDate.setDate(today.getDate() + 90);
            const endDate = new Date(startDate);
            endDate.setHours(startDate.getHours() + 1); // Duração de 1 hora

            // Formatação para UTC no formato YYYYMMDDTHHMMSSZ
            const formatStartDate = (date) => {
                const pad = (num) => String(num).padStart(2, '0');
                return date.getUTCFullYear() +
                    pad(date.getUTCMonth() + 1) +
                    pad(date.getUTCDate()) +
                    'T104500Z';
            };
            
            const formatEndDate = (date) => {
                const pad = (num) => String(num).padStart(2, '0');
                return date.getUTCFullYear() +
                    pad(date.getUTCMonth() + 1) +
                    pad(date.getUTCDate()) +
                    'T110000Z';
            };

            const startDateFormatted = formatStartDate(startDate);
            const endDateFormatted = formatEndDate(endDate);

            // Parâmetros do evento
            const eventTitle = "Agendar uma nova doaçāo";
            const eventDetails = "A partir de hoje, você já pode fazer uma nova doação de sangue! " + 
            "Acesse agora em: https://www.hemosc.org.br/agende-sua-doacao.html";
            const eventLocation = "HEMOSC";

            // Monta o link do Google Agenda
            const calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE` +
                                `&text=${encodeURIComponent(eventTitle)}` +
                                `&dates=${startDateFormatted}/${endDateFormatted}` +
                                `&details=${encodeURIComponent(eventDetails)}` +
                                `&location=${encodeURIComponent(eventLocation)}` +
                                `&ctz=America/Sao_Paulo`;

            // Redireciona para o Google Agenda
            window.location.href = calendarUrl;
        };
    </script>
</head>
<body>
    <p>Redirecionando para o Google Agenda...</p>
</body>
</html>
